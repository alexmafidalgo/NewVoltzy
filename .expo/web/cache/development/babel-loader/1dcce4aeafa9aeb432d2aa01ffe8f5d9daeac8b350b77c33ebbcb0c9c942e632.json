{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { BASE_URL, ENDPOINTS } from \"./config\";\nimport { setToken, getToken } from \"./token\";\nfunction request(_x, _x2) {\n  return _request.apply(this, arguments);\n}\nfunction _request() {\n  _request = _asyncToGenerator(function* (path, body) {\n    var token = yield getToken();\n    var headers = {\n      'Content-Type': 'application/json'\n    };\n    if (token) headers['Authorization'] = \"Bearer \" + token;\n    var res = yield fetch(\"\" + BASE_URL + path, {\n      method: 'POST',\n      headers: headers,\n      body: JSON.stringify(body)\n    });\n    var text = yield res.text();\n    var data = null;\n    try {\n      data = text ? JSON.parse(text) : null;\n    } catch (e) {\n      data = {\n        message: text\n      };\n    }\n    if (!res.ok) {\n      var message = data && data.message ? data.message : res.statusText;\n      throw new Error(message || 'Request failed');\n    }\n    return data;\n  });\n  return _request.apply(this, arguments);\n}\nexport function signUp(_x3) {\n  return _signUp.apply(this, arguments);\n}\nfunction _signUp() {\n  _signUp = _asyncToGenerator(function* (payload) {\n    var data = yield request(ENDPOINTS.SIGN_UP, payload);\n    if (data && data.token) yield setToken(data.token);\n    return data;\n  });\n  return _signUp.apply(this, arguments);\n}\nexport function signIn(_x4, _x5) {\n  return _signIn.apply(this, arguments);\n}\nfunction _signIn() {\n  _signIn = _asyncToGenerator(function* (identifier, password) {\n    var data = yield request(ENDPOINTS.SIGN_IN, {\n      identifier: identifier,\n      password: password\n    });\n    if (data && data.token) yield setToken(data.token);\n    return data;\n  });\n  return _signIn.apply(this, arguments);\n}\nexport function signOut() {\n  return _signOut.apply(this, arguments);\n}\nfunction _signOut() {\n  _signOut = _asyncToGenerator(function* () {\n    return Promise.resolve();\n  });\n  return _signOut.apply(this, arguments);\n}\nexport default {\n  signUp: signUp,\n  signIn: signIn,\n  signOut: signOut\n};","map":{"version":3,"names":["BASE_URL","ENDPOINTS","setToken","getToken","request","_x","_x2","_request","apply","arguments","_asyncToGenerator","path","body","token","headers","res","fetch","method","JSON","stringify","text","data","parse","e","message","ok","statusText","Error","signUp","_x3","_signUp","payload","SIGN_UP","signIn","_x4","_x5","_signIn","identifier","password","SIGN_IN","signOut","_signOut","Promise","resolve"],"sources":["C:/Users/alexm/Documents/Ensino superior/Ano3 Semestre1/Computação Móvel e Ubíqua/NewVoltzy/src/backend/auth.ts"],"sourcesContent":["import { BASE_URL, ENDPOINTS } from './config';\r\nimport { setToken, getToken } from './token';\r\n\r\ntype SignUpData = {\r\n  name: string;\r\n  username: string;\r\n  email: string;\r\n  password: string;\r\n};\r\n\r\nasync function request(path: string, body: any) {\r\n  const token = await getToken();\r\n  const headers: Record<string,string> = { 'Content-Type': 'application/json' };\r\n  if (token) headers['Authorization'] = `Bearer ${token}`;\r\n\r\n  const res = await fetch(`${BASE_URL}${path}`, {\r\n    method: 'POST',\r\n    headers,\r\n    body: JSON.stringify(body)\r\n  });\r\n\r\n  const text = await res.text();\r\n  let data: any = null;\r\n  try { data = text ? JSON.parse(text) : null; } catch (e) { data = { message: text }; }\r\n\r\n  if (!res.ok) {\r\n    const message = data && data.message ? data.message : res.statusText;\r\n    throw new Error(message || 'Request failed');\r\n  }\r\n\r\n  return data;\r\n}\r\n\r\nexport async function signUp(payload: SignUpData) {\r\n  const data = await request(ENDPOINTS.SIGN_UP, payload);\r\n  if (data && data.token) await setToken(data.token);\r\n  return data;\r\n}\r\n\r\nexport async function signIn(identifier: string, password: string) {\r\n  // Send generic identifier field; backend decides if it's email or username\r\n  const data = await request(ENDPOINTS.SIGN_IN, { identifier, password });\r\n  if (data && data.token) await setToken(data.token);\r\n  return data;\r\n}\r\n\r\nexport async function signOut() {\r\n  // If your backend supports server-side signout/revocation, call it here.\r\n  return Promise.resolve();\r\n}\r\n\r\nexport default { signUp, signIn, signOut };\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}